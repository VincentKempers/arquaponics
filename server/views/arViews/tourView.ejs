<%- include('../partials/header.ejs') %>

	<a-scene
		embedded
		arjs='debugUIEnabled: true;'
		>
		<!-- inspector="url: https://aframe.io/releases/0.3.0/aframe-inspector.min.js" -->

		<a-text value="TEST" rotation="270 0 0" position="0 0 0"></a-text>
				
		<a-curve id="a-greenhouse-line" type="Line">
			<%# Example point: <a-curve-point position="-2 1 -3"></a-curve-point> %>
		</a-curve>

		<%#
		Draws a line
		<a-draw-curve id="a-greenhouse-curve" curveref="#a-greenhouse-line" material="shader: line; color: blue;"></a-draw-curve>
		%>

		<a-entity
		id="a-greenhouse-curve"
		clone-along-curve="curve: #a-greenhouse-line; spacing: 0.05; scale: .5 .5 .5; rotation: 0 0 0;" 
		rotation="0 0 0"
		position="0"
		geometry="primitive:box; height:0.1; width:0.2; depth:0.1"
		></a-entity>

		<a-marker-camera preset='hiro'></a-marker-camera>
	</a-scene>



	<script type="text/javascript">
		var sock = new SockJS('http://localhost:9999/echo');
		// var sock = new SockJS('https://0214295b.ngrok.io');
		sock.onopen = function() {
			console.log('open');
			// sock.send('bal');
		};
		
		sock.onmessage = function(e) {
			var data = JSON.parse(e.data);
			// console.log(data.consumption)

			// Push data to the 
			graphData.push(data);

			if (graphData.length) {
				if (graphData.length > 20) {
					graphData.shift();	
				}
				renderLine(graphData);
			} 

		};
		
		sock.onclose = function() {
			console.log('Sock connection closed');
		};
	</script>
	<script src="/scripts/arGraphs.js"></script>

<%- include('../partials/footer.ejs') %>
